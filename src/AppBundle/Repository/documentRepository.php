<?php

namespace AppBundle\Repository;

/**
 * documentRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class documentRepository extends \Doctrine\ORM\EntityRepository
{
    public function getLastDocs( $limit )
    {
        $query = $this->createQueryBuilder('d')
//            ->select('*')
            ->setMaxResults($limit)
            ->orderBy('d.id', 'DESC')
            ->getQuery();
        return $query->getResult();
    }

    public function getParentDoc(){
        $a = 'parent';
        $q = $this->createQueryBuilder('d')
            ->getQuery();
        $allDocs = $q->getResult();
        $outDocs =  new ArrayCollection();
        foreach ($allDocs as $doc){
            $thisDocAccess = explode(",", $doc->getDocaccess());
            if( in_array('parent' , $thisDocAccess)){
                $outDocs->add($doc);
            }
        }
        return $outDocs;
    }

}
